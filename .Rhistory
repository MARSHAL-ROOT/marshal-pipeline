pol_ch%>%
ggplot()+
theme_classic()+
coord_fixed() +
geom_polygon(aes(x = V1, y = V2, fill = factor(rep)), alpha = 0.2)+
ylab("depth (cm)")+
xlab("L (cm)")+
facet_grid(ex ~ age)#+
#labs(fill = "repetitions")+
#theme(legend.position="bottom")
poly_area%>%
ggplot(aes(x = as.factor(age), y = area))+
theme_classic()+
geom_boxplot(aes(fill = ex), alpha = 0.2)+
geom_jitter(aes(shape = ex, colour = ex), size = 3, width = 0.1, height = 0, alpha = 0.5)+
ylab("area (m²)")+
xlab("time (d)")+
labs(colour = "RSA example",
shape = "RSA example")+
guides(fill = F)+
theme(legend.position="bottom")
pol_ch%>%
ggplot()+
theme_classic()+
coord_fixed() +
geom_polygon(aes(x = V1, y = V2, fill = factor(rep)), alpha = 0.2)+
ylab("depth (cm)")+
xlab("L (cm)")+
facet_grid(ex ~ age)+
guides(fill = F)
#labs(fill = "repetitions")+
#theme(legend.position="bottom")
poly_area%>%
ggplot(aes(x = as.factor(age), y = area))+
theme_classic()+
geom_boxplot(aes(fill = ex), alpha = 0.2)+
geom_jitter(aes(shape = ex, colour = ex), size = 3, width = 0.1, height = 0, alpha = 0.5)+
ylab("area (m²)")+
xlab("time (d)")+
labs(colour = "RSA example",
shape = "RSA example")+
guides(fill = F)+
theme(legend.position="bottom")
pol_ch%>%
ggplot()+
theme_classic()+
coord_fixed() +
geom_polygon(aes(x = V1, y = V2, fill = factor(rep)), alpha = 0.2)+
ylab("depth (cm)")+
xlab("L (cm)")+
facet_grid(ex ~ age, labeller =as_labeller(babbel))+
guides(fill = F)
#labs(fill = "repetitions")+
#theme(legend.position="bottom")
poly_area%>%
ggplot(aes(x = as.factor(age), y = area))+
theme_classic()+
geom_boxplot(aes(fill = ex), alpha = 0.2)+
geom_jitter(aes(shape = ex, colour = ex), size = 3, width = 0.1, height = 0, alpha = 0.5)+
ylab("area (m²)")+
xlab("time (d)")+
labs(colour = "RSA example",
shape = "RSA example")+
guides(fill = F)+
theme(legend.position="bottom")
pol_ch%>%
ggplot()+
theme_classic()+
coord_fixed() +
geom_polygon(aes(x = V1, y = V2, fill = factor(rep)), alpha = 0.2)+
ylab("depth (cm)")+
xlab("L (cm)")+
facet_grid(ex ~ age)+
guides(fill = F)
#labs(fill = "repetitions")+
#theme(legend.position="bottom")
poly_area%>%
ggplot(aes(x = as.factor(age), y = area))+
theme_classic()+
geom_boxplot(aes(fill = ex), alpha = 0.2)+
geom_jitter(aes(shape = ex, colour = ex), size = 3, width = 0.1, height = 0, alpha = 0.5)+
ylab("area (m²)")+
xlab("time (d)")+
#labs(colour = "RSA example",
#     shape = "RSA example")+
guides(fill = F,
colour = F,
shape = F)+
theme(legend.position="bottom")
pol_ch%>%
ggplot()+
theme_classic()+
coord_fixed() +
geom_polygon(aes(x = V1, y = V2, fill = factor(rep)), alpha = 0.2)+
ylab("depth (cm)")+
xlab("L (cm)")+
facet_grid(ex ~ age)+
guides(fill = F)
#labs(fill = "repetitions")+
#theme(legend.position="bottom")
poly_area%>%
ggplot(aes(x = as.factor(age), y = area))+
theme_classic()+
geom_boxplot(aes(fill = ex), alpha = 0.2)+
geom_jitter(aes(shape = ex, colour = ex), size = 3, width = 0.1, height = 0, alpha = 0.5)+
ylab("area (m²)")+
xlab("time (d)")+
#labs(colour = "RSA example",
#     shape = "RSA example")+
guides(fill = F,
colour = F,
shape = F)
pol_ch%>%
ggplot()+
theme_classic()+
coord_fixed() +
geom_polygon(aes(x = V1, y = V2, fill = factor(rep)), alpha = 0.2)+
ylab("depth (cm)")+
xlab("L (cm)")+
facet_grid(ex ~ age, labeller =as_labeller(babbel))+
guides(fill = F)
#labs(fill = "repetitions")+
#theme(legend.position="bottom")
poly_area%>%
ggplot(aes(x = as.factor(age), y = area))+
theme_classic()+
geom_boxplot(aes(fill = ex), alpha = 0.2)+
geom_jitter(aes(shape = ex, colour = ex), size = 3, width = 0.1, height = 0, alpha = 0.5)+
ylab("area (m²)")+
xlab("time (d)")+
#labs(colour = "RSA example",
#     shape = "RSA example")+
guides(fill = F,
colour = F,
shape = F)
pol_ch%>%
ggplot()+
theme_classic()+
coord_fixed() +
geom_polygon(aes(x = V1, y = V2, fill = factor(ex)), alpha = 0.2)+
ylab("depth (cm)")+
xlab("L (cm)")+
facet_grid(ex ~ age, labeller =as_labeller(babbel))+
guides(fill = F)
#labs(fill = "repetitions")+
#theme(legend.position="bottom")
poly_area%>%
ggplot(aes(x = as.factor(age), y = area))+
theme_classic()+
geom_boxplot(aes(fill = ex), alpha = 0.2)+
geom_jitter(aes(shape = ex, colour = ex), size = 3, width = 0.1, height = 0, alpha = 0.5)+
ylab("area (m²)")+
xlab("time (d)")+
#labs(colour = "RSA example",
#     shape = "RSA example")+
guides(fill = F,
colour = F,
shape = F)
pol_ch%>%
ggplot()+
theme_classic()+
coord_fixed() +
geom_polygon(aes(x = V1, y = V2, fill = ex), alpha = 0.2)+
ylab("depth (cm)")+
xlab("L (cm)")+
facet_grid(ex ~ age, labeller =as_labeller(babbel))+
guides(fill = F)
#labs(fill = "repetitions")+
#theme(legend.position="bottom")
poly_area%>%
ggplot(aes(x = as.factor(age), y = area))+
theme_classic()+
geom_boxplot(aes(fill = ex), alpha = 0.2)+
geom_jitter(aes(shape = ex, colour = ex), size = 3, width = 0.1, height = 0, alpha = 0.5)+
ylab("area (m²)")+
xlab("time (d)")+
#labs(colour = "RSA example",
#     shape = "RSA example")+
guides(fill = F,
colour = F,
shape = F)
pol_ch%>%
ggplot()+
theme_classic()+
coord_fixed() +
geom_polygon(aes(x = V1, y = V2, fill = factor(rep)), alpha = 0.2)+
ylab("depth (cm)")+
xlab("L (cm)")+
facet_grid(ex ~ age, labeller =as_labeller(babbel))+
guides(fill = F)
#labs(fill = "repetitions")+
#theme(legend.position="bottom")
poly_area%>%
ggplot(aes(x = as.factor(age), y = area))+
theme_classic()+
geom_boxplot(aes(fill = ex), alpha = 0.2)+
geom_jitter(aes(shape = ex, colour = ex), size = 3, width = 0.1, height = 0, alpha = 0.5)+
ylab("area (m²)")+
xlab("time (d)")+
#labs(colour = "RSA example",
#     shape = "RSA example")+
guides(fill = F,
colour = F,
shape = F)
pol_ch%>%
ggplot()+
theme_classic()+
coord_fixed() +
geom_polygon(aes(x = V1, y = V2, fill = factor(rep)), alpha = 0.2)+
ylab("depth (cm)")+
xlab("L (cm)")+
facet_grid(ex ~ age, labeller =as_labeller(babbel))+
guides(fill = F)
#labs(fill = "repetitions")+
#theme(legend.position="bottom")
poly_area%>%
ggplot(aes(x = as.factor(age), y = area))+
theme_classic()+
geom_boxplot(aes(fill = ex), alpha = 0.2)+
geom_jitter(aes(shape = ex, colour = ex), size = 3, width = 0.1, height = 0, alpha = 0.5)+
ylab("area (m²)")+
xlab("time (d)")+
facet_grid()+
#labs(colour = "RSA example",
#     shape = "RSA example")+
guides(fill = F,
colour = F,
shape = F)
pol_ch%>%
ggplot()+
theme_classic()+
coord_fixed() +
geom_polygon(aes(x = V1, y = V2, fill = factor(rep)), alpha = 0.2)+
ylab("depth (cm)")+
xlab("L (cm)")+
facet_grid(ex ~ age, labeller =as_labeller(babbel))+
guides(fill = F)
#labs(fill = "repetitions")+
#theme(legend.position="bottom")
poly_area%>%
ggplot(aes(x = as.factor(age), y = area))+
theme_classic()+
geom_boxplot(aes(fill = ex), alpha = 0.2)+
geom_jitter(aes(shape = ex, colour = ex), size = 3, width = 0.1, height = 0, alpha = 0.5)+
ylab("area (m²)")+
xlab("time (d)")+
facet_grid(~ ex)+
#labs(colour = "RSA example",
#     shape = "RSA example")+
guides(fill = F,
colour = F,
shape = F)
pol_ch%>%
ggplot()+
theme_classic()+
coord_fixed() +
geom_polygon(aes(x = V1, y = V2, fill = factor(rep)), alpha = 0.2)+
ylab("depth (cm)")+
xlab("L (cm)")+
facet_grid(ex ~ age, labeller =as_labeller(babbel))+
guides(fill = F)
#labs(fill = "repetitions")+
#theme(legend.position="bottom")
poly_area%>%
ggplot(aes(x = as.factor(age), y = area))+
theme_classic()+
geom_boxplot(aes(fill = ex), alpha = 0.2)+
geom_jitter(aes(shape = ex, colour = ex), size = 2, width = 0.1, height = 0, alpha = 0.5)+
ylab("area (m²)")+
xlab("time (d)")+
#labs(colour = "RSA example",
#     shape = "RSA example")+
guides(fill = F,
colour = F,
shape = F)
RLD %>%
ggplot(aes(age, rooting_depth, colour = factor(ex)))+
geom_point(size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = -3), size = 2, alpha = 0.5, shape = 14)+ # seeds
geom_hline(yintercept = 0)+
theme_classic()+
facet_wrap(~ex, labeller =as_labeller(babbel))+
guides(colour = F)
RLD %>%
ggplot(aes(age, rooting_depth, colour = factor(ex)))+
geom_point(aes(shape= ex),size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = -3), size = 2, alpha = 0.5, shape = 14)+ # seeds
geom_hline(yintercept = 0)+
theme_classic()+
facet_wrap(~ex, labeller =as_labeller(babbel))+
guides(colour = F)
RLD %>%
ggplot(aes(age, rooting_depth, colour = factor(ex)))+
geom_point(aes(shape= ex, colour = factor(ex)),size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = -3), size = 2, alpha = 0.5, shape = 14)+ # seeds
geom_hline(yintercept = 0)+
theme_classic()+
facet_wrap(~ex, labeller =as_labeller(babbel))+
guides(colour = F)
RLD %>%
ggplot(aes(age, rooting_depth, colour = factor(ex)))+
geom_point(aes(shape= ex, colour = factor(ex)),size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = -3), size = 2, alpha = 0.5, shape = 14)+ # seeds
geom_hline(yintercept = 0)+
theme_classic()+
facet_wrap(~ex, labeller =as_labeller(babbel))
RLD %>%
ggplot(aes(age, rooting_depth, colour = ex))+
geom_point(aes(shape= ex, colour = factor(ex)),size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = -3), size = 2, alpha = 0.5, shape = 14)+ # seeds
geom_hline(yintercept = 0)+
theme_classic()+
facet_wrap(~ex, labeller =as_labeller(babbel))+
labs(colour = "RSA example",
)
RLD %>%
ggplot(aes(age, rooting_depth, colour = ex))+
geom_point(aes(shape= ex, colour = factor(ex)),size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = -3), size = 2, alpha = 0.5, shape = 14)+ # seeds
geom_hline(yintercept = 0)+
theme_classic()+
facet_wrap(~ex, labeller =as_labeller(babbel))+
labs(colour = "RSA example", shape = "RSA example")
RLD %>%
ggplot(aes(age, rooting_depth))+
geom_point(aes(shape= ex, colour = ex),size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = -3, colour ex), size = 2, alpha = 0.5, shape = 14)+ # seeds
RLD %>%
ggplot(aes(age, rooting_depth))+
geom_point(aes(shape= ex, colour = ex),size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = -3, colour = ex), size = 2, alpha = 0.5, shape = 14)+ # seeds
geom_hline(yintercept = 0)+
theme_classic()+
facet_wrap(~ex, labeller =as_labeller(babbel))+
labs(colour = "RSA example", shape = "RSA example")
RLD %>%
ggplot(aes(age, rooting_depth))+
geom_point(aes(shape= ex, colour = ex),size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = -3, colour = ex, shape = ex), size = 2, alpha = 0.5)+ # seeds
geom_hline(yintercept = 0)+
theme_classic()+
facet_wrap(~ex, labeller =as_labeller(babbel))+
labs(colour = "RSA example", shape = "RSA example")
RLD %>%
ggplot(aes(age, rooting_depth))+
geom_point(aes(shape= ex, colour = ex),size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = -3, colour = ex, shape = ex), size = 2, alpha = 0.5)+ # seeds
geom_hline(yintercept = 0, color = "tan3")+
theme_classic()+
facet_wrap(~ex, labeller =as_labeller(babbel))+
labs(colour = "RSA example", shape = "RSA example")
RLD %>%
ggplot(aes(age, rooting_depth))+
geom_point(aes(shape= ex, colour = ex),size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = -3, colour = ex, shape = ex), size = 2, alpha = 0.5)+ # seeds
geom_hline(yintercept = 0, color = "tan3")+
theme_classic()+
facet_wrap(~ex, labeller =as_labeller(babbel))+
labs(colour = "RSA example", shape = "RSA example")+
ylab("Rooting depth (cm)")
RLD %>%
ggplot(aes(age, rooting_depth))+
geom_point(aes(shape= ex, colour = ex),size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = -3, colour = ex, shape = ex), size = 2, alpha = 0.5)+ # seeds
geom_hline(yintercept = 0, color = "tan3")+
theme_classic()+
facet_wrap(~ex, labeller =as_labeller(babbel))+
labs(colour = "RSA example", shape = "RSA example")+
ylab("Rooting depth (cm)")+
xlab("time (day)")
```{r root length, echo= F, fig.cap="Total root length for each of the root system examples", fig.pos = "!h", fig.height= 4}
RLD %>%
ggplot(aes(age, root/1000, colour = factor(ex)))+
geom_point(size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = 0), size = 2)+
theme_classic()+
facet_wrap(~ex, labeller =as_labeller(babbel))+
labs(colour = "RSA example")+
ylab("Total root length (m)")+
xlab("Time (d)")
RLD %>%
ggplot(aes(age, rooting_depth))+
geom_point(aes(shape= ex, colour = ex),size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = -3, colour = ex, shape = ex), size = 2, alpha = 0.5)+ # seeds
geom_hline(yintercept = 0, color = "tan3")+
theme_classic()+
facet_wrap(~ex, labeller =as_labeller(babbel))+
labs(colour = "RSA example", shape = "RSA example")+
ylab("Rooting depth (cm)")+
xlab("time (day)")
all_roots%>%
group_by(age, ex, rep)%>%
summarise(tip = max(sort(unique(branchID))))%>%
ggplot(aes(age, tip, colour = factor(ex)))+
geom_point(size = 2, alpha = 0.5)+
geom_point(aes(x = 0, y = 0), size = 2)+
theme_classic()+
facet_wrap(~ex, labeller =as_labeller(babbel))+
labs(colour = "RSA example")+
ylab("Number of roots")+
xlab("Time (d)")
soil %>%
filter(value %in% c(10,30,50,60))%>%
ggplot(aes(psi, z, colour = factor(value)))+
geom_point(alpha = 0.7)+
theme_classic()+
xlab("Pressure head (hPa)") +
ylab("Depth (cm)")+
labs(colour = "Time (days)")+
facet_grid(~humid, labeller =as_labeller(babbel))+
theme(axis.text.x=element_text(angle=90))
new_all_roots%>%
filter(age == 60,
rep == nrep,
scenario == "Doussan et al.") %>%
ggplot()+
theme_classic()+
coord_fixed() +
geom_segment(data = , aes(x = x1, y = z1, xend = x2, yend = z2, colour = log10(jr)), alpha = 0.8, size = 0.3)+
facet_grid(ex ~ humid, labeller = as_labeller(babbel)) +
scale_color_viridis_c()+
labs(colour = "Radial fluxes \nlog10(cm³/day)")+
ylab("Depth (cm)")
setwd(dir = "~/GitHub/marshal-pipeline")
library(data.table)
library(Matrix)
library(readxl)
library(tidyverse)
library(cowplot)
library(xml2)
library(knitr)
library(marshal) # ! not working
source("R/io_function.R")
source("R/getSUF.R")
conductivities <- read_excel("www/conductivities.xlsx")
conductivities <- conductivities%>%
mutate(scenario = 1)
# Number of repetion per root system architecture example
nrep <- 1
# List of three CrootBox parameter for corn
param_choise <- c("Zea_mays_3_Postma_2011")
all_roots <- NULL
for(param_name in param_choise){
# Load param of the selected example
rparam <- read_rparam(path = paste0("./www/", param_name, ".rparam"))
pparam <- read_pparam(path = paste0("./www/", param_name, ".pparam"))
# Overwrite the param files that will be use
write_rparam(rparam, "./www/param.rparam")
write_pparam(pparam, "./www/param.pparam")
for(i in c(1:nrep)){
# Run CRootBox ----
system("www/a.exe")
# Get all the files exported by CRootBox
fls <- list.files("./")
fls <- fls[grepl("rootsystem.txt", fls)]
for(f in fls){
temp <- fread(f, header = T)
temp$age <- strsplit(f, "_")[[1]][1]
temp$rep <- i
temp$ex <- param_name
all_roots <- rbind(all_roots, temp)
}
}
}
Rootsys <- rsmlToTable(inputrsml = "C:/Users/heymansad/Documents/GitHub/marshal-pipeline")
Rootsys <- rsmlToTable(inputrsml = "C:/Users/heymansad/Documents/GitHub/marshal-pipeline")
library(archiDART)
Rootsys <- rsmlToTable(inputrsml = "C:/Users/heymansad/Documents/GitHub/marshal-pipeline")
Rootsys%>%
ggplot()+
theme_classic()+
coord_fixed()+
geom_segment(data = , aes(x = x1, y = z1, xend = x2, yend = z2, colour = root))
k = 0
branchID <- NULL
for(i in 1:nrow(Rootsys)){
branchID <- c(branchID, k)
if(i > 2){
if(Rootsys$bran[i] == "true"){
k = i+1
}
}
}
a_root <- Rootsys%>%
transmute(node1D = c(0:(nrow(Rootsys)-1)),
node2D = node1D+1,
branchID = branchID,
x1 = x1, y1 = y1, z1 = z1,
x2 = x2, y2 = y2, z2 = z2,
radius = 0.03,
length = length,
R = 0, G = 0, B = 205,
time = time,
type = order)
a_root%>%
ggplot()+
theme_classic()+
coord_fixed()+
geom_segment(data = , aes(x = x1, y = z1, xend = x2, yend = z2, colour = branchID))
a_root%>%
ggplot()+
theme_classic()+
coord_fixed()+
geom_segment(data = , aes(x = x1, y = z1, xend = x2, yend = z2, colour = factor(branchID)))
One_root <- all_roots%>%
filter(age == "60", rep == 1, ex == "Zea_mays_3_Postma_2011")
One_root%>%
ggplot()+
theme_classic()+
coord_fixed()+
geom_segment(data = , aes(x = x1, y = z1, xend = x2, yend = z2, colour = branchID))
unique(Rootsys$parentroot)
